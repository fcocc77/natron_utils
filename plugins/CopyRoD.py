# -*- coding: utf-8 -*-
# DO NOT EDIT THIS FILE
# Natron PyPlug
# This file was automatically generated by Natron PyPlug exporter version 10.

# Hand-written code should be added in a separate file named CopyRoDExt.py
# See http://natron.readthedocs.org/en/master/devel/groups.html#adding-hand-written-code-callbacks-etc
# Note that Viewers are never exported

import NatronEngine
import sys

# Try to import the extensions file where callbacks and hand-written code should be located.
try:
    from CopyRoDExt import *
except ImportError:
    pass

def getPluginID():
    return "vv.copy_rod"

def getLabel():
    return "CopyRoD"
    
def getIconPath():
    return "CopyRoD.png"

def getVersion():
    return 1

def getGrouping():
    return "videovina"

def createInstance(app,group):
    # Create all nodes in the group

    # Create the parameters of the group node the same way we did for all internal nodes
    lastNode = group
    lastNode.setColor(0.7, 0.7, 0.7)

    # Create the user parameters
    lastNode.custom = lastNode.createPageParam("custom", "Custom")
    param = lastNode.createBooleanParam("crop_format", "Crop Format")

    # Add the param to the page
    lastNode.custom.addParam(param)

    # Set param properties
    param.setHelp("")
    param.setAddNewLine(True)
    param.setAnimationEnabled(True)
    param.setValue(True)
    lastNode.crop_format = param
    del param

    # Refresh the GUI with the newly created parameters
    lastNode.setPagesOrder(['custom', 'Node', 'Settings'])
    lastNode.refreshUserParamsGUI()
    del lastNode

    # Start of node "Output1"
    lastNode = app.createNode("fr.inria.built-in.Output", 1, group)
    lastNode.setLabel("Output")
    lastNode.setPosition(805, 302)
    lastNode.setSize(100, 29)
    lastNode.setColor(0.7, 0.7, 0.7)
    groupOutput1 = lastNode

    del lastNode
    # End of node "Output1"

    # Start of node "A"
    lastNode = app.createNode("fr.inria.built-in.Input", 1, group)
    lastNode.setScriptName("A")
    lastNode.setLabel("A")
    lastNode.setPosition(1053, 75)
    lastNode.setSize(100, 29)
    lastNode.setColor(0.3, 0.5, 0.2)
    groupA = lastNode

    del lastNode
    # End of node "A"

    # Start of node "B"
    lastNode = app.createNode("fr.inria.built-in.Input", 1, group)
    lastNode.setScriptName("B")
    lastNode.setLabel("B")
    lastNode.setPosition(805, 64)
    lastNode.setSize(100, 32)
    lastNode.setColor(0.3, 0.5, 0.2)
    groupB = lastNode

    del lastNode
    # End of node "B"

    # Start of node "Crop1"
    lastNode = app.createNode("net.sf.openfx.CropPlugin", 1, group)
    lastNode.setScriptName("Crop1")
    lastNode.setLabel("Crop1")
    lastNode.setPosition(805, 186)
    lastNode.setSize(100, 32)
    lastNode.setColor(0.7, 0.3, 0.1)
    groupCrop1 = lastNode

    param = lastNode.getParam("NatronParamFormatChoice")
    if param is not None:
        param.set("PC_Video")
        del param

    param = lastNode.getParam("bottomLeft")
    if param is not None:
        param.setValue(948.2037369699319, 0)
        param.setValue(-10.05706156412498, 1)
        del param

    param = lastNode.getParam("size")
    if param is not None:
        param.setValue(1332.066044261516, 0)
        param.setValue(1221.561955545889, 1)
        del param

    param = lastNode.getParam("intersect")
    if param is not None:
        param.setValue(True)
        del param

    param = lastNode.getParam("blackOutside")
    if param is not None:
        param.setValue(True)
        del param

    del lastNode
    # End of node "Crop1"

    # Now that all nodes are created we can connect them together, restore expressions
    groupOutput1.connectInput(0, groupCrop1)
    groupCrop1.connectInput(0, groupB)

    param = groupCrop1.getParam("bottomLeft")
    param.setExpression("a = thisGroup.getInput(0)\n\nx = 0\ny = 0\nif a:\n\tx = a.getRegionOfDefinition(frame, 1).x1\n\ty = a.getRegionOfDefinition(frame, 1).y1\n\nif dimension == 0:\n\tret = x\nelse:\n\tret = y", True, 0)
    param.setExpression("a = thisGroup.getInput(0)\n\nx = 0\ny = 0\nif a:\n\tx = a.getRegionOfDefinition(frame, 1).x1\n\ty = a.getRegionOfDefinition(frame, 1).y1\n\nif dimension == 0:\n\tret = x\nelse:\n\tret = y", True, 1)
    del param
    param = groupCrop1.getParam("size")
    param.setExpression("a = thisGroup.getInput(0)\nb = thisGroup.getInput(0)\n\nx, y, w, h = 0,0,0,0\nif a:\n\tx = a.getRegionOfDefinition(frame, 1).x1\n\ty = a.getRegionOfDefinition(frame, 1).y1\n\tw = a.getRegionOfDefinition(frame, 1).x2\n\th = a.getRegionOfDefinition(frame, 1).y2\n\nif dimension == 0:\n\tret = w - x\nelse:\n\tret = h - y", True, 0)
    param.setExpression("a = thisGroup.getInput(0)\nb = thisGroup.getInput(0)\n\nx, y, w, h = 0,0,0,0\nif a:\n\tx = a.getRegionOfDefinition(frame, 1).x1\n\ty = a.getRegionOfDefinition(frame, 1).y1\n\tw = a.getRegionOfDefinition(frame, 1).x2\n\th = a.getRegionOfDefinition(frame, 1).y2\n\nif dimension == 0:\n\tret = w - x\nelse:\n\tret = h - y", True, 1)
    del param
    param = groupCrop1.getParam("intersect")
    param.setExpression("thisGroup.crop_format.get()", False, 0)
    del param

    try:
        extModule = sys.modules["CopyRoDExt"]
    except KeyError:
        extModule = None
    if extModule is not None and hasattr(extModule ,"createInstanceExt") and hasattr(extModule.createInstanceExt,"__call__"):
        extModule.createInstanceExt(app,group)
